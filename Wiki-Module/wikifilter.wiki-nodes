#!/bin/bash
# wikifilter.wiki-nodes
# Interaktive Textsuchhilfe f√ºr .wiki-notes Dateien

DATEI="$1"
SUCHWORT="$2"

if [[ ! -f "$DATEI" ]]; then
  echo "‚ùå Datei '$DATEI' nicht gefunden."
  exit 1
fi

if [[ -z "$SUCHWORT" ]]; then
  echo "‚ÑπÔ∏è  Kein Suchbegriff angegeben. Zeige gesamte Datei:"
  gum pager < "$DATEI"
  exit 0
fi

echo "üîç Suche nach '$SUCHWORT' in: $DATEI"
echo "====================================="
grep -ni --color=always "$SUCHWORT" "$DATEI" | gum choose --no-limit | cut -d: -f1 | while read -r line; do
  echo "üìå Kontext (Zeile $line):"
  sed -n "$((line-2)),$((line+2))p" "$DATEI"
  echo "-------------------------------------"
done
